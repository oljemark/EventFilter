#include <TFile.h>
#include <TCanvas.h>
#include <TH2D.h>
#include <TF1.h>
#include <sstream>
#include <string>
#include <iostream>

int limCh() {
 TFile f("digiHistosT2-4800kEv-r585ZB.root");
 TCanvas MyC;
 gPad->SetLogz();
 std::string pre="chLEtot_";
 int done=0;
 const double p0[64]={105.905,103.446,99.2012,101.431,110.607,103.052,98.6157,115.257,110.044,104.103,94.7829,107.699,111.723,117.958,100.193,99.2175,
	 123.662,104.944,50.,111.529,104.852,108.577,98.9715,117.875,124.12,109.138,109.224,115.525,90.5432,113.128,105.81,93.5588,83.1318,85.4597,
	 84.83,93.4103,85.686,86.907,88.1821,101.546,85.8877,85.3507,82.3997,92.7767,90.7742,92.7982,87.5735,96.5943,92.6675,85.7291,88.1251,100.792,
	 88.3891,88.8163,91.6619,103.913,92.2972,92.6553,87.8767,93.4001,99.0651,90.3839,89.2728,94.3758};

const double p1[64]={-2.23358,-2.14968,-1.99853,-2.06289,-2.33729,-2.17111,-1.98558,-2.49849,-2.33486,-2.15859,-1.87143,-2.31735,-2.41831,-2.58514,
	-2.03566,-2.01594,-2.73494,-2.19588,-5.,-2.423,-2.21459,-2.31166,-2.01716,-2.59355,-2.74318,-2.29707,-2.28681,-2.51903,-1.55417,-2.43759,
	-2.18598,-1.8116,-1.63796,-1.66525,-1.69557,-1.95843,-1.6394,-1.73069,-1.79775,-2.12092,-1.70443,-1.6132,-1.55293,-1.89967,-1.83703,-1.87174,
	-1.78382,-1.99482,-1.83933,-1.68918,-1.70917,-2.09607,-1.74401,-1.72821,-1.86512,-2.1693,-1.89157,-1.80474,-1.76403,-1.89563,-2.01352,
	-1.80108,-1.81861,-1.93399};
 for (int u=0;u<64;u++)
 {
	 std::stringstream titl;
	 titl<<pre;
	 titl<<u;
	 titl<<";1";
	 std::cout<<titl.str()<<std::endl;
	 auto chs=f.Get<TH2D>(titl.str().c_str());
	 if (u!=18) {
		 auto lo=new TF1("lo","[0]+[1]*x",5.,95.);
		 lo->SetParameters(p0[u]-2*6.25,p1[u]);
		 auto hi=new TF1("hi","[0]+[1]*x",5.,95.);
		 hi->SetParameters(p0[u]+2*6.25,p1[u]);
		 chs->Draw("colz");
		 lo->Draw("same");
		 hi->Draw("same");
	 }
	  std::stringstream prt;
	  prt<<"TwoDeeLimitPlots3_2sigma_ch"<<u;
	  prt<<".png";
	  std::cout<<prt.str()<<std::endl;
	  MyC.Print(prt.str().c_str());
	  done++;
 }
 return done;
}
